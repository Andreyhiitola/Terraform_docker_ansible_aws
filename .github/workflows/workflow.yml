# This is a basic workflow to help you get started with Actions
name: My_githubActions
on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]
jobs:
  my_CI_CD:
  #build:
    # The type of runner that the job will run on
    runs-on: ubuntu-latest

    steps:
    - name: Run a one-line script
      run :  echo "Hello, world from testing new!"
      
    - name: pwd directory
      run: pwd
      
    - name: list folder  
      run: ls -la 
           
  # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it
   # - name: Check my repository
    #  uses: actions/checkout@v3
    
   # - name: Run ansible nginx
   #   run: ansible-playbok playbook_nginx.yaml --user ubuntu --key-file mykeypair.pem -e "key=~/.ssh/id_rsa.pub"    
  
 #my_deploy:
 # runs-on: ubuntu-latest
 # needs: [ my_CI-CD ]


- name: Run playbook
  uses: dawidd6/action-ansible-playbook@v2
  with:
    # Required, playbook filepath
    playbook: playbook_nginx.yaml --user ubuntu --key-file mykeypair.pem -e "key=~/.ssh/id_rsa.pub"
    # Optional, directory where playbooks live
    directory: ./Ansible
    # Optional, SSH private key
    key: ${{secrets.SSH_PRIVATE_KEY}}
    # Optional, literal inventory file contents
    #inventory: |
    #  [all]
    #  example.com

      [group1]
      example.com
    # Optional, SSH known hosts file content
    # known_hosts: .known_hosts
    # Optional, encrypted vault password
    # vault_password: ${{secrets.VAULT_PASSWORD}}
    # Optional, galaxy requirements filepath
    #requirements: galaxy-requirements.yml
    # Optional, additional flags to pass to ansible-playbook
    # options: |
    #  --inventory .hosts
     # --limit group1
     # --extra-vars hello=there
     # --verbose
   #steps:
   #- name: Run a one-line script
   #   run: echo Hello, world!
 
      # Runs a set of commands using the runners shell
     - name: Run a multi-line script
       run: |
         echo Add other actions to build,
         echo test, and deploy your project.
